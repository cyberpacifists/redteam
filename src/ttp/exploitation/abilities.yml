---

- id: 4
  name: MSF WP PHP Mailer Host Header
  description: |
    This module exploits a command injection vulnerability in WordPress version 4.6 with Exim as an MTA via a spoofed
    Host header to PHPMailer, a mail-sending library that is bundled with WordPress. A valid WordPress username is
    required to exploit the vulnerability. Additionally, due to the altered Host header, exploitation is limited to
    the default virtual host, assuming the header isn't mangled in transit. If the target is running Apache 2.2.32 or
    2.4.24 and later, the server may have HttpProtocolOptions set to Strict, preventing a Host header containing parens
    from passing through, making exploitation unlikely.
  tactic: technical-information-gathering
  technique: conduct-active-scanning
  parser: msf.yml
  payload: msf.py
  commands:
    - "use exploits/unix/webapp/wp_phpmailer_host_header"
  options:
    - "set TARGET #{TARGET}"
    - "run"